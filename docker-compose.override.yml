services:
  job.api:
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_HTTP_PORTS=8080
      - ASPNETCORE_HTTPS_PORTS=8081
      - COSMOSDB_ENDPOINT=https://localhost:8081/
      - COSMOSDB_KEY=C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw== 
 
    ports:
      - "8080"
      - "8081"
    volumes:
      - ${APPDATA}/Microsoft/UserSecrets:/home/app/.microsoft/usersecrets:ro
      - ${APPDATA}/Microsoft/UserSecrets:/root/.microsoft/usersecrets:ro
      - ${APPDATA}/ASP.NET/Https:/home/app/.aspnet/https:ro
      - ${APPDATA}/ASP.NET/Https:/root/.aspnet/https:ro
    depends_on:
      - azure-cosmosdb-local 

  azure-cosmosdb-local:
    ports:
      - "8081:8081"
    environment:
      - AZURE_COSMOSDB_EMULATOR_PARTITION_COUNT=1
      - AZURE_COSMOSDB_EMULATOR_ENABLE_DATA_PERSISTENCE=true
      - AZURE_COSMOSDB_EMULATOR_ENABLE_ANALYTICS_STORE=true
      - PROTOCOL=https
    volumes:
      - azure_cosmosdb_data:/home/azurecosmosdblocal/data
  